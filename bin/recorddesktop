#!/bin/bash

# Output file basename (extension is added after)
output_basename="$HOME/x11grab-$(date +%s)"

# The resolution of the screen area
# format:
# <width>x<height>
area="$(xdpyinfo | grep 'dimensions:' |awk '{print $2}')"
#area="1920x1080"

# Offset (upper-left corner)
# format:
# +<x_offset>,<y_offset>
offset=""

# Pulse source. List them with: $(pactl list sources)
# this is my pulse output. It could also be the mic input.
pulse_device="alsa_output.pci-0000_00_1b.0.analog-stereo.monitor"

audio_codec="libvorbis -b:a 128k -ac 2"

video_codec="h264 -preset ultrafast -framerate 60"
ext="mp4"

ffmpeg -f x11grab -s $area -i :0.0$offset -threads 1 \
	-f pulse -i $pulse_device -acodec $audio_codec \
	-vcodec $video_codec \
	$output_basename.$ext
